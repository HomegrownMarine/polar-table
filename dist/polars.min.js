/*! homegrown-polars 2015-03-07 */
!function(){"use strict";var a,b=function(a,b){function c(a,b){this.all=a||{},this.targets=b||{up:{},down:{}},this.init()}c.prototype.init=function(){this.twsspeeds={},this.twsspeeds.up=b.keys(this.targets.up),this.twsspeeds.down=b.keys(this.targets.down)},c.prototype.getInterpolatedValue=function(a,c,d){var e=this.targets[d?"up":"down"],f=this.twsspeeds[d?"up":"down"],g=[0,0],h=b.sortedIndex(f,a+.001)||1;g[1]=f[h],g[0]=f[h-1];var i=1-(a-g[0])/(g[1]-g[0]),j=i*e[g[0]][c]+(1-i)*e[g[1]][c];return j};var d=function(a){var b={up:{},down:{}};return function(c,d){var e=Math.round(100*c),f=b[d?"up":"down"];return e in f||(f[e]=this.getInterpolatedValue(c,a,d)),f[e]}};return c.prototype.targetSpeed=d("speed"),c.prototype.targetAngle=d("twa"),c.prototype.targetHeel=d("heel"),a.PolarTable=c,c};a="undefined"!=typeof exports?exports:"undefined"!=typeof module&&module.exports?module.exports:window;var c;"undefined"!=typeof _?c=_:"undefined"!=typeof require&&(c=require("lodash"));var d=b(a,c);if("undefined"!=typeof require){var e=require("fs"),f=require("readline");d.fromTSV=function(a,b){var c=new d,g=f.createInterface({input:e.createReadStream(a),output:process.stdout,terminal:!1});g.on("line",function(a){if(a=a.trim(),0!==a.length&&0!==a.indexOf("#")){var b=!1,d=!0;"*"==a.substring(a.length-1)&&(b=!0,a=a.substring(0,a.length-1));var e=a.split(" "),f=+e[0],g=+e[1],h=+e[2],i=+e[3],j=+e[4];d=90>g,f in c.all||(c.all[f]={}),c.all[f][g]={speed:h,heel:i,lee:j},b&&(c.targets[d?"up":"down"][f]={twa:g,speed:h,heel:i})}}),g.on("close",function(){c.init(),b(c)})}}}();